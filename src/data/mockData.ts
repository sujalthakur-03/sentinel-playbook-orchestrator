// Mock data for CyberSentinel SOAR
// Mirrors expected API responses

import type {
  Alert,
  Playbook,
  Execution,
  Approval,
  Connector,
  AuditEntry,
  SOARMetrics,
} from '@/types/soar';

export const mockAlerts: Alert[] = [
  {
    id: 'ALT-001',
    timestamp: new Date(Date.now() - 120000).toISOString(),
    rule_id: '100002',
    rule_name: 'SSH Brute Force Attempt Detected',
    severity: 'critical',
    agent_id: 'agent-001',
    agent_name: 'prod-web-01',
    mitre_technique: 'T1110',
    mitre_tactic: 'Credential Access',
    description: 'Multiple failed SSH login attempts from 192.168.1.105',
    source_ip: '192.168.1.105',
    destination_ip: '10.0.1.50',
    status: 'new',
    raw_data: {
      srcip: '192.168.1.105',
      dstip: '10.0.1.50',
      attempts: 47,
      user: 'root',
    },
  },
  {
    id: 'ALT-002',
    timestamp: new Date(Date.now() - 300000).toISOString(),
    rule_id: '100101',
    rule_name: 'Suspicious PowerShell Execution',
    severity: 'high',
    agent_id: 'agent-015',
    agent_name: 'corp-ws-042',
    mitre_technique: 'T1059.001',
    mitre_tactic: 'Execution',
    description: 'Base64 encoded PowerShell command detected',
    status: 'acknowledged',
    raw_data: {
      command: 'powershell -enc SGVsbG8gV29ybGQ=',
      user: 'jsmith',
    },
  },
  {
    id: 'ALT-003',
    timestamp: new Date(Date.now() - 600000).toISOString(),
    rule_id: '100205',
    rule_name: 'Unauthorized File Access',
    severity: 'medium',
    agent_id: 'agent-003',
    agent_name: 'file-server-01',
    mitre_technique: 'T1083',
    mitre_tactic: 'Discovery',
    description: 'User accessed sensitive directory without authorization',
    status: 'in_progress',
    raw_data: {
      path: '/data/confidential/',
      user: 'temp_contractor',
    },
  },
  {
    id: 'ALT-004',
    timestamp: new Date(Date.now() - 900000).toISOString(),
    rule_id: '100050',
    rule_name: 'Malware Signature Detected',
    severity: 'critical',
    agent_id: 'agent-022',
    agent_name: 'dev-server-03',
    mitre_technique: 'T1204',
    mitre_tactic: 'Execution',
    description: 'Known malware hash detected in downloaded file',
    status: 'new',
    raw_data: {
      file_hash: 'd41d8cd98f00b204e9800998ecf8427e',
      file_name: 'update.exe',
    },
  },
  {
    id: 'ALT-005',
    timestamp: new Date(Date.now() - 1800000).toISOString(),
    rule_id: '100320',
    rule_name: 'Abnormal Network Traffic',
    severity: 'low',
    agent_id: 'agent-007',
    agent_name: 'gateway-01',
    description: 'Unusual outbound traffic volume detected',
    status: 'resolved',
    raw_data: {
      bytes_out: 1500000000,
      destination: 'cdn.example.com',
    },
  },
];

export const mockPlaybooks: Playbook[] = [
  {
    id: 'PB-001',
    name: 'SSH Brute Force Response',
    description: 'Automated response to SSH brute force attacks. Enriches attacker IP, blocks if malicious.',
    enabled: true,
    version: 3,
    created_at: '2024-10-15T10:00:00Z',
    updated_at: '2024-12-20T14:30:00Z',
    created_by: 'admin@cybersentinel.io',
    trigger: {
      source: 'wazuh',
      rule_ids: ['100002', '100003'],
      severity_threshold: 'high',
    },
    steps: [
      {
        id: 'step-1',
        order: 1,
        type: 'enrichment',
        name: 'Check IP Reputation',
        config: {
          type: 'enrichment',
          source: 'abuseipdb',
          field: 'source_ip',
          output_variable: 'ip_reputation',
        },
        timeout_seconds: 30,
        on_failure: 'continue',
      },
      {
        id: 'step-2',
        order: 2,
        type: 'condition',
        name: 'Evaluate Threat Level',
        config: {
          type: 'condition',
          expression: 'ip_reputation.abuse_score > 80',
          on_true: 'step-3',
          on_false: 'step-5',
        },
        on_failure: 'stop',
      },
      {
        id: 'step-3',
        order: 3,
        type: 'approval',
        name: 'Request Block Approval',
        config: {
          type: 'approval',
          required_role: 'senior_analyst',
          timeout_hours: 1,
          auto_action_on_timeout: 'escalate',
        },
        on_failure: 'stop',
      },
      {
        id: 'step-4',
        order: 4,
        type: 'action',
        name: 'Block IP on Firewall',
        config: {
          type: 'action',
          connector_id: 'firewall-01',
          action_type: 'block_ip',
          parameters: { ip: '{{source_ip}}', duration: '24h' },
        },
        timeout_seconds: 60,
        on_failure: 'stop',
      },
      {
        id: 'step-5',
        order: 5,
        type: 'notification',
        name: 'Send SOC Alert',
        config: {
          type: 'notification',
          channel: 'slack',
          recipients: ['#soc-alerts'],
          template: 'ssh_brute_force_alert',
        },
        on_failure: 'continue',
      },
    ],
    execution_count: 147,
    last_execution: new Date(Date.now() - 3600000).toISOString(),
  },
  {
    id: 'PB-002',
    name: 'Malware Quarantine',
    description: 'Isolate endpoint and collect forensic data when malware is detected.',
    enabled: true,
    version: 2,
    created_at: '2024-11-01T09:00:00Z',
    updated_at: '2024-12-18T11:00:00Z',
    created_by: 'admin@cybersentinel.io',
    trigger: {
      source: 'wazuh',
      rule_ids: ['100050', '100051', '100052'],
      severity_threshold: 'critical',
    },
    steps: [
      {
        id: 'step-1',
        order: 1,
        type: 'action',
        name: 'Isolate Endpoint',
        config: {
          type: 'action',
          connector_id: 'wazuh-active-response',
          action_type: 'isolate_host',
          parameters: { agent_id: '{{agent_id}}' },
        },
        timeout_seconds: 120,
        on_failure: 'stop',
      },
      {
        id: 'step-2',
        order: 2,
        type: 'notification',
        name: 'Notify Security Team',
        config: {
          type: 'notification',
          channel: 'email',
          recipients: ['security-team@company.com'],
          template: 'malware_detected',
        },
        on_failure: 'continue',
      },
    ],
    execution_count: 23,
    last_execution: new Date(Date.now() - 86400000).toISOString(),
  },
  {
    id: 'PB-003',
    name: 'Phishing Response',
    description: 'Analyze reported phishing emails and block malicious URLs.',
    enabled: false,
    version: 1,
    created_at: '2024-12-01T15:00:00Z',
    updated_at: '2024-12-01T15:00:00Z',
    created_by: 'analyst@cybersentinel.io',
    trigger: {
      source: 'wazuh',
      rule_ids: ['100400'],
      severity_threshold: 'medium',
    },
    steps: [
      {
        id: 'step-1',
        order: 1,
        type: 'enrichment',
        name: 'Analyze URL',
        config: {
          type: 'enrichment',
          source: 'virustotal',
          field: 'url',
          output_variable: 'url_analysis',
        },
        timeout_seconds: 60,
        on_failure: 'continue',
      },
    ],
    execution_count: 0,
  },
];

export const mockExecutions: Execution[] = [
  {
    id: 'EXE-001',
    playbook_id: 'PB-001',
    playbook_name: 'SSH Brute Force Response',
    alert_id: 'ALT-001',
    state: 'WAITING_APPROVAL',
    started_at: new Date(Date.now() - 180000).toISOString(),
    current_step: 3,
    steps: [
      {
        step_id: 'step-1',
        step_name: 'Check IP Reputation',
        type: 'enrichment',
        state: 'completed',
        started_at: new Date(Date.now() - 180000).toISOString(),
        completed_at: new Date(Date.now() - 175000).toISOString(),
        input: { ip: '192.168.1.105' },
        output: { abuse_score: 92, country: 'RU', isp: 'Unknown ISP' },
      },
      {
        step_id: 'step-2',
        step_name: 'Evaluate Threat Level',
        type: 'condition',
        state: 'completed',
        started_at: new Date(Date.now() - 174000).toISOString(),
        completed_at: new Date(Date.now() - 174000).toISOString(),
        input: { abuse_score: 92 },
        output: { result: true, next_step: 'step-3' },
      },
      {
        step_id: 'step-3',
        step_name: 'Request Block Approval',
        type: 'approval',
        state: 'running',
        started_at: new Date(Date.now() - 173000).toISOString(),
        input: { proposed_action: 'Block IP 192.168.1.105' },
      },
      {
        step_id: 'step-4',
        step_name: 'Block IP on Firewall',
        type: 'action',
        state: 'pending',
        input: {},
      },
      {
        step_id: 'step-5',
        step_name: 'Send SOC Alert',
        type: 'notification',
        state: 'pending',
        input: {},
      },
    ],
  },
  {
    id: 'EXE-002',
    playbook_id: 'PB-002',
    playbook_name: 'Malware Quarantine',
    alert_id: 'ALT-004',
    state: 'COMPLETED',
    started_at: new Date(Date.now() - 900000).toISOString(),
    completed_at: new Date(Date.now() - 850000).toISOString(),
    steps: [
      {
        step_id: 'step-1',
        step_name: 'Isolate Endpoint',
        type: 'action',
        state: 'completed',
        started_at: new Date(Date.now() - 900000).toISOString(),
        completed_at: new Date(Date.now() - 860000).toISOString(),
        input: { agent_id: 'agent-022' },
        output: { status: 'isolated', isolation_id: 'ISO-4521' },
      },
      {
        step_id: 'step-2',
        step_name: 'Notify Security Team',
        type: 'notification',
        state: 'completed',
        started_at: new Date(Date.now() - 859000).toISOString(),
        completed_at: new Date(Date.now() - 850000).toISOString(),
        input: { recipients: ['security-team@company.com'] },
        output: { sent: true, message_id: 'MSG-9812' },
      },
    ],
  },
  {
    id: 'EXE-003',
    playbook_id: 'PB-001',
    playbook_name: 'SSH Brute Force Response',
    alert_id: 'ALT-005',
    state: 'FAILED',
    started_at: new Date(Date.now() - 7200000).toISOString(),
    completed_at: new Date(Date.now() - 7100000).toISOString(),
    steps: [
      {
        step_id: 'step-1',
        step_name: 'Check IP Reputation',
        type: 'enrichment',
        state: 'failed',
        started_at: new Date(Date.now() - 7200000).toISOString(),
        completed_at: new Date(Date.now() - 7100000).toISOString(),
        input: { ip: '10.0.0.1' },
        error: 'AbuseIPDB API timeout after 30s',
      },
    ],
    error: 'Enrichment step failed: API timeout',
  },
];

export const mockApprovals: Approval[] = [
  {
    id: 'APR-001',
    execution_id: 'EXE-001',
    playbook_name: 'SSH Brute Force Response',
    alert: mockAlerts[0],
    proposed_action: 'Block IP on Firewall',
    action_details: {
      ip: '192.168.1.105',
      duration: '24h',
      firewall: 'pf-edge-01',
    },
    requested_at: new Date(Date.now() - 173000).toISOString(),
    expires_at: new Date(Date.now() + 3427000).toISOString(),
    status: 'pending',
  },
  {
    id: 'APR-002',
    execution_id: 'EXE-004',
    playbook_name: 'Credential Theft Response',
    alert: mockAlerts[1],
    proposed_action: 'Disable User Account',
    action_details: {
      user: 'jsmith',
      reason: 'Suspicious PowerShell activity',
    },
    requested_at: new Date(Date.now() - 600000).toISOString(),
    expires_at: new Date(Date.now() + 3000000).toISOString(),
    status: 'pending',
  },
];

export const mockConnectors: Connector[] = [
  {
    id: 'firewall-01',
    name: 'Palo Alto Firewall',
    type: 'firewall',
    status: 'healthy',
    enabled: true,
    last_check: new Date(Date.now() - 60000).toISOString(),
    last_execution: new Date(Date.now() - 3600000).toISOString(),
    execution_count: 234,
    error_count: 2,
    actions: ['block_ip', 'unblock_ip', 'add_rule', 'remove_rule'],
  },
  {
    id: 'wazuh-active-response',
    name: 'Wazuh Active Response',
    type: 'edr',
    status: 'healthy',
    enabled: true,
    last_check: new Date(Date.now() - 30000).toISOString(),
    last_execution: new Date(Date.now() - 86400000).toISOString(),
    execution_count: 89,
    error_count: 0,
    actions: ['isolate_host', 'kill_process', 'collect_logs'],
  },
  {
    id: 'slack-integration',
    name: 'Slack Notifications',
    type: 'notification',
    status: 'healthy',
    enabled: true,
    last_check: new Date(Date.now() - 45000).toISOString(),
    last_execution: new Date(Date.now() - 1800000).toISOString(),
    execution_count: 1247,
    error_count: 5,
    actions: ['send_message', 'create_channel', 'invite_user'],
  },
  {
    id: 'email-smtp',
    name: 'Email (SMTP)',
    type: 'notification',
    status: 'degraded',
    enabled: true,
    last_check: new Date(Date.now() - 120000).toISOString(),
    execution_count: 456,
    error_count: 23,
    actions: ['send_email'],
  },
  {
    id: 'virustotal-api',
    name: 'VirusTotal',
    type: 'enrichment',
    status: 'healthy',
    enabled: true,
    last_check: new Date(Date.now() - 15000).toISOString(),
    last_execution: new Date(Date.now() - 300000).toISOString(),
    execution_count: 2341,
    error_count: 12,
    actions: ['scan_hash', 'scan_url', 'scan_file'],
  },
  {
    id: 'abuseipdb-api',
    name: 'AbuseIPDB',
    type: 'enrichment',
    status: 'error',
    enabled: true,
    last_check: new Date(Date.now() - 5000).toISOString(),
    execution_count: 1892,
    error_count: 156,
    actions: ['check_ip', 'report_ip'],
  },
];

export const mockAuditLog: AuditEntry[] = [
  {
    id: 'AUD-001',
    timestamp: new Date(Date.now() - 300000).toISOString(),
    actor: 'admin@cybersentinel.io',
    actor_role: 'admin',
    action: 'playbook.update',
    resource_type: 'playbook',
    resource_id: 'PB-001',
    details: { version: 3, changes: ['Updated severity threshold'] },
    ip_address: '10.0.1.15',
    outcome: 'success',
  },
  {
    id: 'AUD-002',
    timestamp: new Date(Date.now() - 173000).toISOString(),
    actor: 'SYSTEM',
    actor_role: 'automation',
    action: 'approval.create',
    resource_type: 'approval',
    resource_id: 'APR-001',
    details: { execution_id: 'EXE-001', playbook: 'SSH Brute Force Response' },
    ip_address: '127.0.0.1',
    outcome: 'success',
  },
  {
    id: 'AUD-003',
    timestamp: new Date(Date.now() - 850000).toISOString(),
    actor: 'analyst@cybersentinel.io',
    actor_role: 'senior_analyst',
    action: 'approval.approve',
    resource_type: 'approval',
    resource_id: 'APR-003',
    details: { reason: 'Confirmed malicious activity from threat intel' },
    ip_address: '10.0.1.22',
    outcome: 'success',
  },
  {
    id: 'AUD-004',
    timestamp: new Date(Date.now() - 900000).toISOString(),
    actor: 'SYSTEM',
    actor_role: 'automation',
    action: 'execution.complete',
    resource_type: 'execution',
    resource_id: 'EXE-002',
    details: { playbook: 'Malware Quarantine', duration_ms: 50000 },
    ip_address: '127.0.0.1',
    outcome: 'success',
  },
  {
    id: 'AUD-005',
    timestamp: new Date(Date.now() - 7100000).toISOString(),
    actor: 'SYSTEM',
    actor_role: 'automation',
    action: 'execution.fail',
    resource_type: 'execution',
    resource_id: 'EXE-003',
    details: { error: 'AbuseIPDB API timeout' },
    ip_address: '127.0.0.1',
    outcome: 'failure',
  },
];

export const mockMetrics: SOARMetrics = {
  mttr_seconds: 847,
  mttr_trend: -12.5,
  automated_actions: 1892,
  manual_actions: 234,
  automation_rate: 89,
  top_playbooks: [
    { id: 'PB-001', name: 'SSH Brute Force Response', execution_count: 147, success_rate: 94.5 },
    { id: 'PB-002', name: 'Malware Quarantine', execution_count: 23, success_rate: 100 },
    { id: 'PB-005', name: 'DDoS Mitigation', execution_count: 12, success_rate: 91.7 },
  ],
  failed_executions: 8,
  pending_approvals: 2,
  alerts_processed_24h: 342,
  connector_health: {
    healthy: 4,
    degraded: 1,
    error: 1,
  },
};
